<!DOCTYPE html>
<html lang="zh-cn">
    <head>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HZXHKZW7E0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HZXHKZW7E0');
</script>
<meta name="google-site-verification" content="PgRvRggX4FPNmBfLmc_IBoedK_gPlyCB_p49I3DfNSA" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noodp"/>
    <meta name="author" content="ANY_ME">
    <meta name="description" content="shishuoCh的个人博客">
    
    <meta name="google-site-verification" content=" " />
    <link rel="prev" href="https://shishuochen.github.io/2024/p5zazebsd/" />
    
    <link rel="canonical" href="https://shishuochen.github.io/2024/ucfmxndck/" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <title>
        
        
            Python科研绘图系列 | shishuoCh&#39;s Blog
        
    </title>
    <meta name="title" content="Python科研绘图系列 | shishuoCh&#39;s Blog">
    
<link rel="stylesheet" href="/css/main.min.css">


    
    
 

<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/shishuochen.github.io"
    },
    "articleSection" : "posts",
    "name" : "Python科研绘图系列",
    "headline" : "Python科研绘图系列",
    "description" : "大论文也算是写完交一段时间了，回想自己每次要画图的时候也是满世界找方案（GPT问的最多😅）。虽然以后99%不会再画这些图了，但是还是想把论文",
    "inLanguage" : "zh-cn",
    "author" : "ANY_ME",
    "creator" : "ANY_ME",
    "publisher": "ANY_ME",
    "accountablePerson" : "ANY_ME",
    "copyrightHolder" : "ANY_ME",
    "copyrightYear" : "2024",
    "datePublished": "2024-04-23 14:26:33 \u002b0800 CST",
    "dateModified" : "2024-04-23 14:26:33 \u002b0800 CST",
    "url" : "https:\/\/shishuochen.github.io\/2024\/ucfmxndck\/",
    "wordCount" : "2526",
    "keywords" : [ "Python","科研绘图", "shishuoCh\u0027s Blog"]
}
</script>

	<link rel="stylesheet" href=
"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.css">
</link>
    
    <script src="https://kit.fontawesome.com/860bffd803.js" crossorigin="anonymous"></script>
	


  </head>
    <body class="">
        <div class="wrapper">
            <nav class="navbar">
    
        <progress class="content_progress" max="0" value="0"></progress>
    
    <div class="container">
        
            <div class="navbar-header header-back2home-logo">
                <span class="logo_mark" >>$</span>
                <a href="https://shishuochen.github.io">
                    <span class="logo_text" >cd /home/</span>
                    <span class="logo_cursor" ></span>
                </a>
            </div>
        
        <div class="navbar-right">
                
                <span class="menu">
                
                <a class="menu-item" href="/posts/" title="">📖Blog</a>
                
                <a class="menu-item" href="/categories/" title="">📁Categories</a>
                
                <a class="menu-item" href="/tags/" title="">🎨Tags</a>
                
                <a class="menu-item" href="/about/" title="">💬About</a>
                
                <a class="menu-item" href="/about/" title="">ANY_ME</a>
                
                <span class="divide"></span>
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a>
                </span>
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display:none">
    
        <progress class="content_progress" max="0" value="0"></progress>
    
     <div class="container">
        <div class="navbar">
            <div class="navbar-header header-logo">
                    <a href="https://shishuochen.github.io">shishuoCh&#39;s Blog</a>
            </div>
            <div class="navbar-right">
                <div><a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a></div>
                <div class="menu-toggle">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                <nav class="mb-md">
                    
                    
                        <a class="menu-item" href="/posts/" title="" white-space="nowrap">
						<nobr>📖Blog</nobr>
                            <div class="menu-active"></div>
							</a>
                    
                        <a class="menu-item" href="/categories/" title="" white-space="nowrap">
						<nobr>📁Categories</nobr>
                            <div class="menu-active"></div>
							</a>
                    
                        <a class="menu-item" href="/tags/" title="" white-space="nowrap">
						<nobr>🎨Tags</nobr>
                            <div class="menu-active"></div>
							</a>
                    
                        <a class="menu-item" href="/about/" title="" white-space="nowrap">
						<nobr>💬About</nobr>
                            <div class="menu-active"></div>
							</a>
                    
                        <a class="menu-item" href="/about/" title="" white-space="nowrap">
						<nobr>ANY_ME</nobr>
                            <div class="menu-active"></div>
							</a>
                    
                </nav>
        </div>
    </div>
</nav>
            <main class="main">
                <div class="container">
                    
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Python科研绘图系列</h1>
        <div class="post-meta">
                <i class="fas fa-user-circle"></i> <a itemprop="name" href="https://shishuochen.github.io" rel="author">ANY_ME</a> 
				&thinsp;$\bm\vert$&thinsp; 
				<i class="fas fa-calendar-check "></i>
				发布:2024-04-23
				
                </span>
                
				&thinsp;$\bm\vert$&thinsp; 
				
				
                
				&thinsp;$\bm\vert$&thinsp; 
                
                <i class="fas fa-folder-open "></i>
                <span class="post-category">
                        
                        
                        
                          <a href="https://shishuochen.github.io/categories/%E7%A7%91%E7%A0%94%E5%88%A9%E5%99%A8/"> 科研利器</a>
                        
                        
                </span>
				
				&thinsp;$\bm\vert$&thinsp; 
				<i class="fas fa-file-word "></i>
				
                <span class="post-word-count">2526字</span>
				
				&thinsp;$\bm\vert$&thinsp;   
				<i class="fas fa-coffee "></i>
				
                <span class="post-word-count">8分钟</span>
				
        </div>
    </header>
	  
     
          <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title"></h2>
  
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#本文可以学到哪些">本文可以学到哪些</a>
<ul>
<li><a href="#python读取mat文件">Python读取MAT文件</a>
<ul>
<li><a href="#出现的问题">出现的问题</a></li>
</ul></li>
<li><a href="#混淆矩阵类">混淆矩阵类</a>
<ul>
<li><a href="#模型分组示例">模型分组示例</a></li>
<li><a href="#模型块对应不同值">模型块对应不同值</a></li>
</ul></li>
<li><a href="#小提琴图">小提琴图</a>
<ul>
<li><a href="#两-多-组数据">两（多）组数据</a></li>
<li><a href="#两-多-组比较">两（多）组比较</a></li>
</ul></li>
<li><a href="#极角直方图">极角直方图</a></li>
<li><a href="#均值误差图-带有显著标识">均值误差图（带有显著标识）</a></li>
<li><a href="#平均曲线以及置信区间">平均曲线以及置信区间</a></li>
<li><a href="#图片添加序号">图片添加序号</a></li>
<li><a href="#最后的最后">最后的最后</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
<script type="text/javascript">
  window.onload = function () {
    var fix = $('.post-toc');
    var end = $('.post-comment');
    var fixTop = fix.offset().top, fixHeight = fix.height();
    var endTop, miss;
    var offsetTop = fix[0].offsetTop;
    $(window).scroll(function () {
      var docTop = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
      if (end.length > 0) {
        endTop = end.offset().top;
        miss = endTop - docTop - fixHeight;
      }
      if (fixTop < docTop) {
        fix.css({ 'position': 'fixed' });
        if ((end.length > 0) && (endTop < (docTop + fixHeight))) {
          fix.css({ top: miss });
        } else {
          fix.css({ top: 0 });
        }
      } else {
        fix.css({ 'position': 'absolute' });
        fix.css({ top: offsetTop });
      }
    })
  }
</script> 
	
	<hr class="hr-twill-colorful">
    <div class="post-content">
        
        
        
            
        
        
        
        
        
        

        
        
        
        

<p><i class="fas fa-quote-left fa-2x fa-pull-left"></i> 大论文也算是写完交一段时间了，回想自己每次要画图的时候也是满世界找方案（GPT问的最多😅）。虽然以后99%不会再画这些图了，但是还是想把论文用到的一些绘图代码记录在此，也许会有有缘人需要🤣🤣🤣。</p>

<hr />

<h2 id="本文可以学到哪些">本文可以学到哪些</h2>

<p>在正式进入主题之前，先介绍一下Python读取MAT文件数据的方法。因为本人的实验数据都是MATLAB跑出来的结果，存放在MAT文件中。Python读取并绘图的时候出现了一些问题，在这里记录下。此后，便是一系列绘图示例。</p>

<h3 id="python读取mat文件">Python读取MAT文件</h3>

<h4 id="出现的问题">出现的问题</h4>

<ol>
<li><p>一般来说，我都是用Scipy库的<code>io</code>模块进行MAT文件的读取。scipy.io 模块是 Scipy 库中的一个子模块，用于处理输入输出操作。它提供了许多函数来读取和写入各种格式的文件，包括 MATLAB 文件、wav 文件、图像文件等。下面是一些 scipy.io 模块中常用的功能：</p>

<ul>
<li><p><strong>scipy.io.loadmat()：用于加载 MATLAB 格式的 .mat 文件。</strong></p></li>

<li><p>scipy.io.savemat()：用于保存数据到 MATLAB 格式的 .mat 文件。</p></li>

<li><p>scipy.io.wavfile.read()：用于读取 WAV 音频文件。</p></li>

<li><p>scipy.io.wavfile.write()：用于写入数据到 WAV 音频文件。</p></li>

<li><p>scipy.io.load()：通用的加载函数，支持多种文件格式，如 .wav、.png、.jpg 等。</p></li>

<li><p>scipy.io.save()：通用的保存函数，支持多种文件格式，如 .wav、.png、.jpg 等。</p></li>
</ul></li>

<li><p>但是直到出现这个报错：<strong>从报错信息中可以看出是因为MATLAB保存MAT文件使用的是v7.3或更高的版本保存的</strong>，换成h5py读取就可以了。可以参考这篇文章的介绍: <a href="https://blog.csdn.net/weixin_45404593/article/details/123828898" rel="nofollow noreferrer" target="_blank">使用python读取Matlab的.mat文件 常见问题</a>
<a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9wAIJ.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9wAIJ.png" style="zoom: 60%;">
</a>
<figcaption class="image-caption">读取MAT文件报错</figcaption></p></li>
</ol>

<h3 id="混淆矩阵类">混淆矩阵类</h3>

<h4 id="模型分组示例">模型分组示例</h4>

<ol>
<li><p><strong>代码实现：</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">from</span> matplotlib.colors <span style="color:#f92672">import</span> ListedColormap
<span style="color:#f92672">import</span> matplotlib.patches <span style="color:#66d9ef">as</span> mpatches

<span style="color:#75715e"># 创建模拟数据</span>
data_A <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">30</span>],
                [<span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>]])
<span style="color:#75715e"># 自定义颜色列表</span>
colors <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;skyblue&#39;</span>, <span style="color:#e6db74">&#39;white&#39;</span>, <span style="color:#e6db74">&#39;salmon&#39;</span>]  <span style="color:#75715e"># 每个矩阵块对应的颜色</span>

<span style="color:#75715e"># 创建自定义颜色映射</span>
cmap_custom <span style="color:#f92672">=</span> ListedColormap(colors)

<span style="color:#75715e"># 设置图片尺寸</span>
fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(dpi <span style="color:#f92672">=</span> <span style="color:#ae81ff">300</span>)

<span style="color:#75715e"># 绘制热力图，并根据自定义颜色映射显示</span>
im <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>imshow(data_A, cmap<span style="color:#f92672">=</span>cmap_custom)

<span style="color:#75715e"># 设置坐标轴刻度和标签</span>
ax<span style="color:#f92672">.</span>set_xticks(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">6</span>))
ax<span style="color:#f92672">.</span>set_xticklabels([<span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;3&#39;</span>, <span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;5&#39;</span>, <span style="color:#e6db74">&#39;6&#39;</span>])
ax<span style="color:#f92672">.</span>set_yticks(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">2</span>))
ax<span style="color:#f92672">.</span>set_yticklabels([<span style="color:#e6db74">&#39;Group 1&#39;</span>, <span style="color:#e6db74">&#39;Group 2&#39;</span>])

<span style="color:#75715e"># 设置坐标轴标签</span>
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Models&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Families&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)  

<span style="color:#75715e"># 添加图形标题</span>
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Families&#39; partition&#34;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)  
legend_elements <span style="color:#f92672">=</span> [mpatches<span style="color:#f92672">.</span>Patch(facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;DoG Models&#39;</span>),
                mpatches<span style="color:#f92672">.</span>Patch(facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;salmon&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Gauss Models&#39;</span>)]
ax<span style="color:#f92672">.</span>legend(handles<span style="color:#f92672">=</span>legend_elements, loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;upper right&#39;</span>)
<span style="color:#75715e"># 调整子图布局以防止标签被剪裁</span>
plt<span style="color:#f92672">.</span>tight_layout()
<span style="color:#75715e"># 显示图形</span>
plt<span style="color:#f92672">.</span>show()</code></pre></div></li>

<li><p><strong>示例结果</strong></p></li>
</ol>

<p><a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9BKED.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9BKED.png" style="zoom: 75%;">
</a>
<figcaption class="image-caption">模型分组示例</figcaption></p>

<h4 id="模型块对应不同值">模型块对应不同值</h4>

<ol>
<li><p><strong>代码示例</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt

<span style="color:#75715e"># 设置全局字体和字号</span>
plt<span style="color:#f92672">.</span>rcParams<span style="color:#f92672">.</span>update({<span style="color:#e6db74">&#39;font.family&#39;</span>: <span style="color:#e6db74">&#39;sans-serif&#39;</span>, <span style="color:#e6db74">&#39;font.size&#39;</span>: <span style="color:#ae81ff">12</span>})

<span style="color:#75715e"># 创建相关矩阵数据</span>
data_A <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">0.36</span>, <span style="color:#ae81ff">0.29</span>, <span style="color:#ae81ff">0.07</span>],
                [<span style="color:#ae81ff">0.16</span>, <span style="color:#ae81ff">0.11</span>, <span style="color:#ae81ff">0.01</span>]])

data_B <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">1.00</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
                [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]])

<span style="color:#75715e"># 绘制A图</span>
fig, ax1 <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>),dpi <span style="color:#f92672">=</span> <span style="color:#ae81ff">300</span>)
im_A <span style="color:#f92672">=</span> ax1<span style="color:#f92672">.</span>imshow(data_A, interpolation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nearest&#39;</span>, cmap<span style="color:#f92672">=</span>plt<span style="color:#f92672">.</span>cm<span style="color:#f92672">.</span>Blues)
cbar_A <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>colorbar(im_A)
ax1<span style="color:#f92672">.</span>set_xticks(np<span style="color:#f92672">.</span>arange(data_A<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]))
ax1<span style="color:#f92672">.</span>set_yticks(np<span style="color:#f92672">.</span>arange(data_A<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]))
ax1<span style="color:#f92672">.</span>set_xticklabels([<span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;3&#39;</span>], fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)
ax1<span style="color:#f92672">.</span>set_yticklabels([<span style="color:#e6db74">&#39;DoG&#39;</span>, <span style="color:#e6db74">&#39;Gauss&#39;</span>], fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>, verticalalignment<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(data_A<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(data_A<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]):
        text_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;black&#39;</span>
        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> j <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            text_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;white&#39;</span>
        text <span style="color:#f92672">=</span> ax1<span style="color:#f92672">.</span>text(j, i, data_A[i, j], ha<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>, va<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>, color<span style="color:#f92672">=</span>text_color)

ax1<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Model probabilities&#39;</span>, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>, pad<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)</code></pre></div></li>

<li><p><strong>示例结果</strong></p></li>
</ol>

<p><a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9Bw5Q.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9Bw5Q.png" style="zoom: 30%;">
</a>
<figcaption class="image-caption">类似混淆矩阵</figcaption></p>

<h3 id="小提琴图">小提琴图</h3>

<h4 id="两-多-组数据">两（多）组数据</h4>

<ol>
<li><p><strong>代码示例</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np

<span style="color:#75715e"># 生成随机数据</span>
np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">0</span>)
data1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)  <span style="color:#75715e"># 左脑数据</span>
data2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)  <span style="color:#75715e"># 右脑数据</span>

<span style="color:#75715e"># 绘制小提琴图</span>
plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>))
sns<span style="color:#f92672">.</span>violinplot(data<span style="color:#f92672">=</span>[data1, data2], palette<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;#FF5D5C&#39;</span>, <span style="color:#e6db74">&#39;#0D5BFF&#39;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>)

<span style="color:#75715e"># 设置图形参数</span>
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Eccentricity&#34;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
plt<span style="color:#f92672">.</span>xticks(ticks<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], labels<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;Left hemisphere&#34;</span>, <span style="color:#e6db74">&#34;Right hemisphere&#34;</span>], fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)

<span style="color:#75715e"># 显示图形</span>
plt<span style="color:#f92672">.</span>show()</code></pre></div></li>

<li><p><strong>示例结果</strong></p></li>
</ol>

<p><a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9rtAS.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9rtAS.png" style="zoom: 80%;">
</a>
<figcaption class="image-caption">两组数据绘制</figcaption></p>

<h4 id="两-多-组比较">两（多）组比较</h4>

<ol>
<li><p><strong>代码示例</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd

<span style="color:#75715e"># 生成随机数据</span>
np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">0</span>)
data1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)  <span style="color:#75715e"># 随机生成左脑数据1</span>
data2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)  <span style="color:#75715e"># 随机生成左脑数据2</span>
data3 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)  <span style="color:#75715e"># 随机生成右脑数据1</span>
data4 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)  <span style="color:#75715e"># 随机生成右脑数据2</span>

<span style="color:#75715e"># 构建数据框</span>
df1 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Data&#39;</span>: data1, <span style="color:#e6db74">&#39;Group&#39;</span>: [<span style="color:#e6db74">&#39;Group 1&#39;</span>] <span style="color:#f92672">*</span> len(data1), <span style="color:#e6db74">&#39;Subgroup&#39;</span>: [<span style="color:#e6db74">&#39;Subgroup 1&#39;</span>] <span style="color:#f92672">*</span> len(data1)})
df2 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Data&#39;</span>: data2, <span style="color:#e6db74">&#39;Group&#39;</span>: [<span style="color:#e6db74">&#39;Group 1&#39;</span>] <span style="color:#f92672">*</span> len(data2), <span style="color:#e6db74">&#39;Subgroup&#39;</span>: [<span style="color:#e6db74">&#39;Subgroup 2&#39;</span>] <span style="color:#f92672">*</span> len(data2)})
df3 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Data&#39;</span>: data3, <span style="color:#e6db74">&#39;Group&#39;</span>: [<span style="color:#e6db74">&#39;Group 2&#39;</span>] <span style="color:#f92672">*</span> len(data3), <span style="color:#e6db74">&#39;Subgroup&#39;</span>: [<span style="color:#e6db74">&#39;Subgroup 1&#39;</span>] <span style="color:#f92672">*</span> len(data3)})
df4 <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Data&#39;</span>: data4, <span style="color:#e6db74">&#39;Group&#39;</span>: [<span style="color:#e6db74">&#39;Group 2&#39;</span>] <span style="color:#f92672">*</span> len(data4), <span style="color:#e6db74">&#39;Subgroup&#39;</span>: [<span style="color:#e6db74">&#39;Subgroup 2&#39;</span>] <span style="color:#f92672">*</span> len(data4)})

<span style="color:#75715e"># 合并数据框</span>
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df1, df2, df3, df4])
colors <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;#FF5D5C&#34;</span>, <span style="color:#e6db74">&#34;#0D5BFF&#34;</span>]

<span style="color:#75715e"># 绘制小提琴图</span>
plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>))
ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>violinplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Group&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Data&#39;</span>, hue<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Subgroup&#39;</span>, data<span style="color:#f92672">=</span>df, split<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, inner<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;quartile&#39;</span>, palette<span style="color:#f92672">=</span>colors, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>)

<span style="color:#75715e"># 设置图形参数</span>
plt<span style="color:#f92672">.</span>xticks(ticks<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], labels<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Left Hemisphere&#39;</span>, <span style="color:#e6db74">&#39;Right Hemisphere&#39;</span>], fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Eccentricity (deg)&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
legend <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>legend(fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">13</span>, loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;upper right&#39;</span>, bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1.35</span>, <span style="color:#ae81ff">1</span>))
legend<span style="color:#f92672">.</span>get_texts()[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_text(<span style="color:#e6db74">&#34;Split1&#34;</span>)
legend<span style="color:#f92672">.</span>get_texts()[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_text(<span style="color:#e6db74">&#34;Split2&#34;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div></li>

<li><p><strong>示例结果</strong></p></li>
</ol>

<p><a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9r2h4.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9r2h4.png" style="zoom: 80%;">
</a>
<figcaption class="image-caption">带有比较的</figcaption></p>

<h3 id="极角直方图">极角直方图</h3>

<blockquote>
<p><strong>极角直方图没有什么难度，但是如果想在直方图的外圈添加Colorbar又该如何实现那？</strong></p>
</blockquote>

<p><strong>参考链接：</strong> <a href="https://stackoverflow.com/questions/31940285/plot-a-polar-color-wheel-based-on-a-colormap-using-python-matplotlib" rel="nofollow noreferrer" target="_blank">Plot a (polar) color wheel based on a colormap using Python/Matplotlib</a></p>

<ol>
<li><p><strong>实现代码</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> cm
<span style="color:#f92672">import</span> matplotlib <span style="color:#66d9ef">as</span> mpl
<span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#39;ticks&#39;</span>)

fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
<span style="color:#75715e"># 随机数据</span>
ang1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#f92672">-</span>np<span style="color:#f92672">.</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, np<span style="color:#f92672">.</span>pi <span style="color:#f92672">/</span><span style="color:#ae81ff">2</span> , size<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)
ang2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(np<span style="color:#f92672">.</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span> , np<span style="color:#f92672">.</span>pi <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)

<span style="color:#75715e"># 绘制环形的Colorbar</span>
display_axes <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_axes([<span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.8</span>, <span style="color:#ae81ff">0.8</span>], projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;polar&#39;</span>)
norm <span style="color:#f92672">=</span> mpl<span style="color:#f92672">.</span>colors<span style="color:#f92672">.</span>Normalize(np<span style="color:#f92672">.</span>pi, <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi)
quant_steps <span style="color:#f92672">=</span> <span style="color:#ae81ff">2056</span>
cb <span style="color:#f92672">=</span> mpl<span style="color:#f92672">.</span>colorbar<span style="color:#f92672">.</span>ColorbarBase(display_axes,
                            cmap<span style="color:#f92672">=</span>cm<span style="color:#f92672">.</span>get_cmap(<span style="color:#e6db74">&#39;hsv_r&#39;</span>, quant_steps),
                            norm<span style="color:#f92672">=</span>norm,
                            orientation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;horizontal&#39;</span>)
cb<span style="color:#f92672">.</span>outline<span style="color:#f92672">.</span>set_visible(<span style="color:#66d9ef">False</span>)
display_axes<span style="color:#f92672">.</span>set_axis_off()

<span style="color:#75715e"># 在大的极坐标子图上绘制直方图</span>
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_axes([<span style="color:#ae81ff">0.15</span>, <span style="color:#ae81ff">0.15</span>, <span style="color:#ae81ff">0.7</span>, <span style="color:#ae81ff">0.7</span>], projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;polar&#39;</span>)  <span style="color:#75715e"># 调整位置和大小</span>

ax<span style="color:#f92672">.</span>hist(ang1, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#FF5D5C&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>,alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Left hemisphere&#39;</span>)
ax<span style="color:#f92672">.</span>hist(ang2, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#0D5BFF&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>,alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Right hemisphere&#39;</span>)
ax<span style="color:#f92672">.</span>set_rticks([<span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.5</span>])  <span style="color:#75715e"># 设置只显示0.5和1.0两个标签</span>
ax<span style="color:#f92672">.</span>set_xticklabels([])
ax<span style="color:#f92672">.</span>spines[<span style="color:#e6db74">&#39;polar&#39;</span>]<span style="color:#f92672">.</span>set_visible(<span style="color:#66d9ef">False</span>)
<span style="color:#75715e"># plt.text(-0.1, 1.07, &#39;A&#39;, transform=ax.transAxes, fontsize=18, fontweight=&#39;bold&#39;, va=&#39;top&#39;)</span>
plt<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;upper right&#39;</span>,fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">14</span>)</code></pre></div></li>

<li><p><strong>结果示例</strong></p></li>
</ol>

<p><a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9Wles.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9Wles.png" style="zoom: 80%;">
</a>
<figcaption class="image-caption">带有环形Colorbar的极角直方图</figcaption></p>

<h3 id="均值误差图-带有显著标识">均值误差图（带有显著标识）</h3>

<ol>
<li><p><strong>代码实现</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
<span style="color:#f92672">import</span> scipy.stats <span style="color:#66d9ef">as</span> stats
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#39;font.size&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>

<span style="color:#75715e"># 生成随机数据</span>
np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">0</span>)
group1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
group2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)

<span style="color:#75715e"># 计算均值和标准误差</span>
mean_group1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean(group1)
mean_group2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean(group2)
sem_group1 <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>sem(group1)
sem_group2 <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>sem(group2)

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">5</span>))

bar <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>bar([<span style="color:#e6db74">&#39;Contralateral&#39;</span>, <span style="color:#e6db74">&#39;Ipsilateral&#39;</span>], [mean_group1, mean_group2], yerr<span style="color:#f92672">=</span>[sem_group1, sem_group2], capsize<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>, color<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;salmon&#39;</span>,<span style="color:#e6db74">&#39;skyblue&#39;</span>])
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Explained variance (mean)&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Right hemisphere&#39;</span>,y<span style="color:#f92672">=</span><span style="color:#ae81ff">1.02</span>)

<span style="color:#75715e"># 添加显著性标注</span>
gap <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span> <span style="color:#75715e"># 显著性标注与最大高度的距离</span>
t <span style="color:#f92672">=</span> max(mean_group1, mean_group2) <span style="color:#f92672">+</span> gap
plt<span style="color:#f92672">.</span>axhline(y<span style="color:#f92672">=</span>t, xmin<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>, xmax<span style="color:#f92672">=</span><span style="color:#ae81ff">0.75</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;-&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
plt<span style="color:#f92672">.</span>plot([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [t, t <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.3</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
plt<span style="color:#f92672">.</span>plot([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>], [t, t <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.3</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
plt<span style="color:#f92672">.</span>text(<span style="color:#ae81ff">0.5</span>, t <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.1</span>, <span style="color:#e6db74">&#39;***&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)

<span style="color:#75715e"># 在柱形图顶部标记均值和标准误差</span>
text_gap <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>  <span style="color:#75715e"># 数值标记的高度</span>
<span style="color:#66d9ef">for</span> i, rect <span style="color:#f92672">in</span> enumerate(bar):
    height <span style="color:#f92672">=</span> rect<span style="color:#f92672">.</span>get_height()
    plt<span style="color:#f92672">.</span>text(rect<span style="color:#f92672">.</span>get_x() <span style="color:#f92672">+</span> rect<span style="color:#f92672">.</span>get_width()<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, height <span style="color:#f92672">+</span> text_gap, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>height<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> ± </span><span style="color:#e6db74">{</span>sem_group1 <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> sem_group2<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>, ha<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>, va<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bottom&#39;</span>)

plt<span style="color:#f92672">.</span>ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">17</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div></li>

<li><p><strong>结果示例</strong></p></li>
</ol>

<p><a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9fM9K.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9fM9K.png" style="zoom: 80%;">
</a>
<figcaption class="image-caption">带有显著标识的均值误差图</figcaption></p>

<h3 id="平均曲线以及置信区间">平均曲线以及置信区间</h3>

<ol>
<li><p><strong>代码实现（仅作自用，不多解释）</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">import</span> scipy.io <span style="color:#66d9ef">as</span> scio
<span style="color:#f92672">import</span> h5py
<span style="color:#75715e"># 假设有一个数据框 data_df，其中每列代表一个样本曲线的观测值</span>
dataFile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;E:</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">我的论文</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">00-论文写作</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">AA_sub_half_HRF_12_DOG1_th.mat&#39;</span> 
mat_data <span style="color:#f92672">=</span> h5py<span style="color:#f92672">.</span>File(dataFile,<span style="color:#e6db74">&#39;r&#39;</span>)
data_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(mat_data[<span style="color:#e6db74">&#39;hrf_t1&#39;</span>])
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#39;font.size&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">6</span>))
<span style="color:#75715e"># 计算每个样本曲线的均值和标准误差</span>
<span style="color:#75715e"># 计算每组数据的均值和标准误差</span>
<span style="color:#75715e"># data_df= data_df.loc[:,:]</span>
mean_values <span style="color:#f92672">=</span> data_df<span style="color:#f92672">.</span>mean()
se_values <span style="color:#f92672">=</span> data_df<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: np<span style="color:#f92672">.</span>std(x) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>sqrt(len(x)))

<span style="color:#75715e"># 计算置信区间</span>
lower_ci <span style="color:#f92672">=</span> mean_values <span style="color:#f92672">-</span> <span style="color:#ae81ff">1.96</span> <span style="color:#f92672">*</span> se_values
upper_ci <span style="color:#f92672">=</span> mean_values <span style="color:#f92672">+</span> <span style="color:#ae81ff">1.96</span> <span style="color:#f92672">*</span> se_values

<span style="color:#75715e"># 创建x轴的刻度</span>
x_values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, len(mean_values)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)

<span style="color:#75715e"># 创建数据框</span>
data_plot <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;x&#39;</span>: x_values, <span style="color:#e6db74">&#39;mean&#39;</span>: mean_values, <span style="color:#e6db74">&#39;lower_ci&#39;</span>: lower_ci, <span style="color:#e6db74">&#39;upper_ci&#39;</span>: upper_ci})

<span style="color:#75715e"># 绘制均值曲线和置信区间</span>

plt<span style="color:#f92672">.</span>plot(data_plot[<span style="color:#e6db74">&#39;x&#39;</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">16</span>, data_plot[<span style="color:#e6db74">&#39;mean&#39;</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#E07E35&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">1.1</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DoG-1 HRF&#39;</span>)
plt<span style="color:#f92672">.</span>fill_between(data_plot[<span style="color:#e6db74">&#39;x&#39;</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">16</span>, data_plot[<span style="color:#e6db74">&#39;lower_ci&#39;</span>], data_plot[<span style="color:#e6db74">&#39;upper_ci&#39;</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#E07E35&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)

<span style="color:#75715e"># dataFile = &#39;E:\\我的论文\\00-论文写作\\hrf_th_dog2.mat&#39; </span>
<span style="color:#75715e"># mat_data = h5py.File(dataFile,&#39;r&#39;)</span>
data_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(mat_data[<span style="color:#e6db74">&#39;hrf_t2&#39;</span>])
<span style="color:#75715e"># 计算每个样本曲线的均值和标准误差</span>
<span style="color:#75715e"># 计算每组数据的均值和标准误差</span>
<span style="color:#75715e"># data_df= data_df.loc[:,:]</span>
mean_values <span style="color:#f92672">=</span> data_df<span style="color:#f92672">.</span>mean()
se_values <span style="color:#f92672">=</span> data_df<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: np<span style="color:#f92672">.</span>std(x) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>sqrt(len(x)))

<span style="color:#75715e"># 计算置信区间</span>
lower_ci <span style="color:#f92672">=</span> mean_values <span style="color:#f92672">-</span> <span style="color:#ae81ff">1.96</span> <span style="color:#f92672">*</span> se_values
upper_ci <span style="color:#f92672">=</span> mean_values <span style="color:#f92672">+</span> <span style="color:#ae81ff">1.96</span> <span style="color:#f92672">*</span> se_values

<span style="color:#75715e"># 创建x轴的刻度</span>
x_values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, len(mean_values)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)

<span style="color:#75715e"># 创建数据框</span>
data_plot <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;x&#39;</span>: x_values, <span style="color:#e6db74">&#39;mean&#39;</span>: mean_values, <span style="color:#e6db74">&#39;lower_ci&#39;</span>: lower_ci, <span style="color:#e6db74">&#39;upper_ci&#39;</span>: upper_ci})

<span style="color:#75715e"># 绘制均值曲线和置信区间</span>

plt<span style="color:#f92672">.</span>plot(data_plot[<span style="color:#e6db74">&#39;x&#39;</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">16</span>, data_plot[<span style="color:#e6db74">&#39;mean&#39;</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#0D5BFF&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">1.1</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DoG-2 HRF&#39;</span>,linestyle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;dashdot&#39;</span>)
plt<span style="color:#f92672">.</span>fill_between(data_plot[<span style="color:#e6db74">&#39;x&#39;</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">16</span>, data_plot[<span style="color:#e6db74">&#39;lower_ci&#39;</span>], data_plot[<span style="color:#e6db74">&#39;upper_ci&#39;</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#0D5BFF&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)


dataFile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;E:</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">我的论文</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">00-论文写作</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">caonical_hrf.mat&#39;</span> 
mat_data <span style="color:#f92672">=</span> h5py<span style="color:#f92672">.</span>File(dataFile,<span style="color:#e6db74">&#39;r&#39;</span>)
data_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(mat_data[<span style="color:#e6db74">&#39;t&#39;</span>])
mean_values <span style="color:#f92672">=</span> data_df<span style="color:#f92672">.</span>mean()
x_values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, len(mean_values)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)

se_values <span style="color:#f92672">=</span> data_df<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: np<span style="color:#f92672">.</span>std(x) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>sqrt(len(x)))
data_plot <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;x&#39;</span>: x_values, <span style="color:#e6db74">&#39;mean&#39;</span>: mean_values})
plt<span style="color:#f92672">.</span>plot(data_plot[<span style="color:#e6db74">&#39;x&#39;</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">16</span>, data_plot[<span style="color:#e6db74">&#39;mean&#39;</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">1.2</span>,label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Canonical HRF&#39;</span>,linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dashed&#39;</span>)

<span style="color:#75715e"># 设置图形属性</span>
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Time (s)&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Amplitude (a.u.)&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Hemodynamic Variability&#39;</span>, loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)
plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
plt<span style="color:#f92672">.</span>legend(fontsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>)
<span style="color:#75715e"># plt.savefig(&#39;hrf_wm_.pdf&#39;, format=&#39;pdf&#39;, bbox_inches=&#39;tight&#39;,pad_inches=0)</span>
<span style="color:#75715e"># plt.yticks(np.arange(0, 1,8))</span>
plt<span style="color:#f92672">.</span>show()</code></pre></div></li>

<li><p><strong>结果示例</strong></p></li>
</ol>

<p><a data-fancybox="gallery" href="https://s21.ax1x.com/2024/04/23/pk9fhgU.png" pcked="1"><img src="https://s21.ax1x.com/2024/04/23/pk9fhgU.png" style="zoom: 60%;">
</a>
<figcaption class="image-caption">均值曲线以及置信区间</figcaption></p>

<h3 id="图片添加序号">图片添加序号</h3>

<ol>
<li><p><strong>代码实现</strong></p>

<ul>
<li><p>这个位置什么的只能一点点尝试了~</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>text(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.13</span>, <span style="color:#ae81ff">1.13</span>, <span style="color:#e6db74">&#39;A&#39;</span>, transform<span style="color:#f92672">=</span>ax<span style="color:#f92672">.</span>transAxes, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">18</span>, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>, va<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;top&#39;</span>)</code></pre></div></li>
</ul></li>
</ol>

<h3 id="最后的最后">最后的最后</h3>

<p>GPT是个好东西，没事多用用~</p>

<hr />

<p><center></p>

<p>$\cdots$ <strong>什么都略懂一点，生活更多彩一些</strong> $\cdots$</p>

<p></center></p>

<p><center></p>

<p>$\cdots$ <strong>end</strong> $\cdots$</p>

<p></center></p>

    </div>
    <div class="post-copyright">
            
            <p class="copyright-item">
                <span>Author:</span>
                <span>ANY_ME </span>
                </p>
            

            
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://shishuochen.github.io/2024/ucfmxndck/>https://shishuochen.github.io/2024/ucfmxndck/</span>
            </p>
            
            
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>


    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s):
            
            <span class="tag"><a href="https://shishuochen.github.io/tags/python/">
                    #Python</a></span>
            
            <span class="tag"><a href="https://shishuochen.github.io/tags/%E7%A7%91%E7%A0%94%E7%BB%98%E5%9B%BE/">
                    #科研绘图</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> ·
                <span><a href="https://shishuochen.github.io">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://shishuochen.github.io/2024/p5zazebsd/" class="prev" rel="prev" title="Nilearn：Python可视化MRI工具"><i class="fas fa-caret-left"></i>&nbsp;Nilearn：Python可视化MRI工具</a>
        
        
    </div>
	        <style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 90%;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style>
    <div class="post-comment">
        
            
                <script src="https://giscus.app/client.js"
        data-repo="shishuochen/Bolg-comments"
        data-repo-id="R_kgDOIFZV3A"
        data-category="Q&A"
        data-category-id="DIC_kwDOIFZV3M4CZ_1B"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
<style>
    .utterances {
        max-width: 99%;
    }
</style>
            
        

    </div>
</article>
                </div>
                <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
            </main>
            
<div class="footer-box">
<footer class="footer">
   <div class="copyright">
      &copy;
      
      <span itemprop="copyrightYear">2019 - 2024</span>
      
      <span class="with-love">
         <i class="fas fa-heart"></i>
      </span>
      
      <span class="author" itemprop="copyrightHolder"><a href="https://shishuochen.github.io">ANY_ME</a> |
      </span>
      
      
	  <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
      <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a
            href="https://github.com/Mogeko/Mogege" target="_blank" rel="external nofollow">Mogege</a></span>
</footer>

      <div class="back-to-top" id="back_to_top">
         
         <span><i class="fas fa-arrow-up"></i></span>
         
         <span class="scrollpercent">
            <span id="back_to_top_text">0</span>%
         </span>
      </div>
</div>
<script>

   let sideBarOpen = 'sidebar-open';
   let body = document.body;
   let back2Top = document.querySelector('#back_to_top'),
      back2TopText = document.querySelector('#back_to_top_text'),
      drawerBox = document.querySelector('#drawer_box'),
      rightSideBar = document.querySelector('.sidebar'),
      viewport = document.querySelector('body');

   function scrollAnimation(currentY, targetY) {

      let needScrollTop = targetY - currentY
      let _currentY = currentY
      setTimeout(() => {
         const dist = Math.ceil(needScrollTop / 10)
         _currentY += dist
         window.scrollTo(_currentY, currentY)
         if (needScrollTop > 10 || needScrollTop < -10) {
            scrollAnimation(_currentY, targetY)
         } else {
            window.scrollTo(_currentY, targetY)
         }
      }, 1)
   }

   back2Top.addEventListener("click", function (e) {
      scrollAnimation(document.scrollingElement.scrollTop, 0);
      e.stopPropagation();
      return false;
   });

   window.addEventListener('scroll', function (e) {
      let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
      if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
         back2Top.classList.add('back-top-active');
      }
      if (percent == 0) {
         back2Top.classList.remove('back-top-active');
      }
      if (back2TopText) {
         back2TopText.textContent = Math.floor(percent);
      }
   });
</script>






<script defer src="/js/vendor_main.min.js"></script>




<script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/love.min.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha256-V8SV2MO1FUb63Bwht5Wx9x6PVHNa02gv8BgH/uH3ung=" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha256-F/Xda58SPdcUCr+xhSGz9MA2zQBPb0ASEYKohl8UCHc=" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha256-90d2pnfw0r4K8CZAWPko4rpFXQsZvJhTBGYNkipDprI=" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
           delimiters: [
     {left: "$$", right: "$$", display: true},
     {left: "$", right: "$", display: false},
   ],
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/gh/jmnote/plantuml-encoder@1.2.4/dist/plantuml-encoder.min.js"></script>
<script>
(function(){
    let plantumlPrefix = "language-plantuml";
    Array.prototype.forEach.call(document.querySelectorAll("[class^=" + plantumlPrefix + "]"), function(code){
        let image = document.createElement("IMG");
        image.loading = 'lazy'; 
        image.src = 'http://www.plantuml.com/plantuml/svg/~1' + plantumlEncoder.encode(code.innerText);
        code.parentNode.insertBefore(image, code);
        code.style.display = 'none'
    });
})();
</script>




<script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script> pangu.spacingPage();</script>




<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
        </div>
    </body>
</html>

